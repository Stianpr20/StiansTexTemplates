%========== Headers and footers ==========%

% Main package
\usepackage{fancyhdr}	

% Margins
\setlength{\headheight}{16pt}

%----- Styles -----%
% Main style in the document
\fancypagestyle{main}{%
	\renewcommand{\chaptermark}[1]{\markboth{##1}{}}
	\renewcommand{\sectionmark}[1]{\markright{##1}{}}
	\renewcommand{\headrulewidth}{0.4pt}
	\renewcommand{\footrulewidth}{0.4pt}
	\fancyhead[LE,RO]{\hyperlink{toclabel}{\small\leftmark}}
	\fancyfoot[LO,RE]{}
	\fancyfoot[LE,RO]{\hyperlink{toclabel}{\small\thepage}}
	}

% Plain
\fancypagestyle{plain}{%
	% Clear all header and footer fields:
		\fancyhf{}
	\renewcommand{\headrulewidth}{0pt}
	\renewcommand{\footrulewidth}{0.4pt}
	\fancyhead{}
	\fancyfoot[LE,RO]{\hyperlink{toclabel}{\small\thepage}}
	}

% Publication attachment style
\newcounter{publication}
% \setcounter{publication}{0}
\fancypagestyle{publication}{%
	\renewcommand{\sectionmark}[1]{\markright{##1}{}}
	\renewcommand{\headrule}{{\color{gray}%
		\hrule width\headwidth height\headrulewidth \vskip-\headrulewidth}}  % ChkTeX 1; ChkTeX 41
	\renewcommand{\footrule}{{\color{gray}%
  		\vskip-\footruleskip\vskip-\footrulewidth%                           % ChkTeX 41
		\hrule width\headwidth height\footrulewidth\vskip\footruleskip}}     % ChkTeX 1; ChkTeX 41
	\renewcommand{\headrulewidth}{1.25pt}
	\renewcommand{\footrulewidth}{1.25pt}
	\fancyhead[C]{\small\currentPublicationName}
	\fancyhead[LE,RO]{}
	\fancyfoot[LO,RE]{Publication\ \thepublication}
	\fancyfoot[LE,RO]{\hyperlink{toclabel}{\small\thepage}}
	}


%----- Miscellaneous -----%
% Patch for moving the footnote under the foot rule:
% https://tex.stackexchange.com/questions/23486/footnote-in-footer
\let\origfootrule\footrule
\renewcommand{\footrule}{\iffootnote{}{\origfootrule}}
\renewcommand\footnoterule{\origfootrule}
